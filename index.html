<!DOCTYPE html><html lang="zh_CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>L1nk's Blog</title><meta name="author" content="L1nk"><meta name="copyright" content="L1nk"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="hi, I am Li1nk">
<meta property="og:type" content="website">
<meta property="og:title" content="L1nk&#39;s Blog">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="L1nk&#39;s Blog">
<meta property="og:description" content="hi, I am Li1nk">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/image/icon.jpg">
<meta property="article:author" content="L1nk">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/image/icon.jpg"><link rel="shortcut icon" href="/image/icon.jpg"><link rel="canonical" href="http://example.com/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'L1nk\'s Blog',
  isHighlightShrink: false,
  isToc: false,
  pageType: 'home'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><script>window.paceOptions = {
  restartOnPushState: false
}

btf.addGlobalFn('pjaxSend', () => {
  Pace.restart()
}, 'pace_restart')

</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js/themes/blue/pace-theme-minimal.min.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="web_bg" style="background-image: url(/image/cover/background.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/image/icon.jpg" onerror="this.onerror=null;this.src='/img/icon.jpg'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">24</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background: transparent;"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">L1nk's Blog</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="site-info"><h1 id="site-title">L1nk's Blog</h1><div id="site-subtitle"><span id="subtitle"></span></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts nc" id="recent-posts"><div class="recent-post-items"><div class="recent-post-item"><div class="post_cover left"><a href="/2025/04/11/glibc-all-in-one%20Failed%20to%20download%20package%E6%80%8E%E4%B9%88%E5%8A%9E/" title="glibc-all-in-one 下载后 Failed to download package 怎么办"><img class="post-bg" src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="glibc-all-in-one 下载后 Failed to download package 怎么办"></a></div><div class="recent-post-info"><a class="article-title" href="/2025/04/11/glibc-all-in-one%20Failed%20to%20download%20package%E6%80%8E%E4%B9%88%E5%8A%9E/" title="glibc-all-in-one 下载后 Failed to download package 怎么办">glibc-all-in-one 下载后 Failed to download package 怎么办</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-04-11T12:01:45.742Z" title="Created 2025-04-11 20:01:45">2025-04-11</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-04-11T12:12:05.340Z" title="Updated 2025-04-11 20:12:05">2025-04-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Pwn/">Pwn</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/glibc-all-in-one/">glibc-all-in-one</a></span></div><div class="content">0x00 起因在做 LitCTF 2024 heap-2.27 的时候，由于这个题是一个堆题，题目给了 libc 文件，打算先通过 glibc-all-in-one 得到对应的 ld 文件。 1strings libc-2.27.so | grep &#x27;ubuntu&#x27; 对应 glibc 版本为：2.27-3ubuntu1.6_amd64 0x01 下载失败但是当我正想输入 1./download 2.27-3ubuntu1.6_amd64 来下载时，得到的结果却是： 1234Getting 2.27-3ubuntu1.6_amd64-&gt; Location:https://mirror.tuna.tsinghua.edu.cn/ubuntu/pool/main/g/glibc/libc6_2.27-3ubuntu1.6.deb-&gt; Downloading libc binary packageFailed to download package from...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2025/04/11/LitCTF%202024%20heap-2.27/" title="LitCTF 2024 heap-2.27(Tcache attack啦)"><img class="post-bg" src="/image/cover/tcache.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="LitCTF 2024 heap-2.27(Tcache attack啦)"></a></div><div class="recent-post-info"><a class="article-title" href="/2025/04/11/LitCTF%202024%20heap-2.27/" title="LitCTF 2024 heap-2.27(Tcache attack啦)">LitCTF 2024 heap-2.27(Tcache attack啦)</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-04-11T07:56:37.338Z" title="Created 2025-04-11 15:56:37">2025-04-11</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-04-11T08:18:39.237Z" title="Updated 2025-04-11 16:18:39">2025-04-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Pwn/">Pwn</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Tcache-attack/">Tcache attack</a></span></div><div class="content">0x00 前言初见Tcache，好像没有想象中的难，所以这篇文章篇幅不太长，属于随便写写吧。吐槽：这个甚至有点简单 0x01 速通思路主要是一个 unsorted bin 来泄露 libc 基地址，然后利用 Tcache 来 malloc 任意地址，通过编辑堆这个功能组合成任意地址写，将 free_hook 写成 system, 然后 free 一个内容为 binsh 的堆 0x02 前置准备题目给了 libc 文件，可以通过： 1strings libc-2.27.so | grep &#x27;ubuntu&#x27; 来找到合适的 libc 版本。版本为：2.27-3ubuntu1.6_amd64。patch 一下然后正式开始 0x03 分析一下越来越懒了，现在打堆题都懒得 checksec 了：很多保护，但是不要紧，先看看 ida：经典菜单堆，大致看了一下，有 uaf：没有堆溢出啦，但是 2.27 中加入了 Tcache 一机制，Tcache 可以理解成没有大小的 fast bin。大致看一眼 CTFWIKI Tcache attack...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2025/04/03/PWN_Emo_Chunk%201/" title="当无脑将__malloc_hook覆盖成one_gadget但所有one_gadget都打不通的时候该怎么做"><img class="post-bg" src="/image/cover/malloc.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="当无脑将__malloc_hook覆盖成one_gadget但所有one_gadget都打不通的时候该怎么做"></a></div><div class="recent-post-info"><a class="article-title" href="/2025/04/03/PWN_Emo_Chunk%201/" title="当无脑将__malloc_hook覆盖成one_gadget但所有one_gadget都打不通的时候该怎么做">当无脑将__malloc_hook覆盖成one_gadget但所有one_gadget都打不通的时候该怎么做</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-04-03T03:13:14.254Z" title="Created 2025-04-03 11:13:14">2025-04-03</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-04-10T02:42:17.338Z" title="Updated 2025-04-10 10:42:17">2025-04-10</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Pwn/">Pwn</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/pie/">pie</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E5%A0%86%E6%BA%A2%E5%87%BA/">堆溢出</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/malloc-hook/">malloc_hook</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/realloc-hook/">realloc_hook</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/realloc/">realloc</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E8%B0%83%E8%8A%82%E6%A0%88%E5%B8%A7/">调节栈帧</a></span></div><div class="content">0x01 前言做到这题的时候想到一个严重的问题，这种菜单堆题以前我都是怎么做的呢？都是通过堆溢出&#x2F;uaf 在 __malloc_hook 附近伪造一个 fake chunk 然后将其申请下来，再通过堆编辑来将原本的 __malloc_hook 覆盖成 one_gadget。尝试运行一遍打不通，就换一个 one_gadget，但是其实我没有想过为什么会打不通以及当所有 one_gadget 都打不通的时候怎么办？ 0x02 如何解决？ 学到了一个新的手段，我们可以利用 realloc 来调整栈帧，在网络上搜索到了一篇博客，大佬详细解释了我上面的问题以及如何解决，现在用一道会有这种情况的题目来实际操作一下，题目是PolarCTF2023秋季个人挑战赛的Emo_chunk  0x03 分析：Checksec：Patch 过了，顺便吐槽一下这个靶场好多堆题都不给 libc 版本，但是看官方解说视频又不说为什么用他那个版本，看到视频里用的是 libc.2.23 就用 2.23 来 patch 了。上 ida：典型菜单堆题，而且有 shell 函数:但是我一开始没有看到，用了...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2025/03/25/2025%E6%98%A5%E5%AD%A3%E8%B5%9B_bll_ezheap1/" title="小萌新的第一次堆溢出+fast bins attack"><img class="post-bg" src="/image/cover/heap.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="小萌新的第一次堆溢出+fast bins attack"></a></div><div class="recent-post-info"><a class="article-title" href="/2025/03/25/2025%E6%98%A5%E5%AD%A3%E8%B5%9B_bll_ezheap1/" title="小萌新的第一次堆溢出+fast bins attack">小萌新的第一次堆溢出+fast bins attack</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-03-25T11:30:27.796Z" title="Created 2025-03-25 19:30:27">2025-03-25</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-03-26T12:16:15.719Z" title="Updated 2025-03-26 20:16:15">2025-03-26</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Pwn/">Pwn</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/heap-overflow/">heap overflow</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/fast-bin-attack/">fast bin attack</a></span></div><div class="content">0x01 前言：题型是一个利用堆溢出来实现Fastbin Attack的题啊，十分适合入门理解，孩子啃得很香。原题目是PolarCTF2025春季个人挑战赛的bll_ezheap1，一道入门堆题。记得堆题上来就要patch！版本之间会有些莫名其妙的差异，很多情况下会导致你本地打不通。 0x02 patch 一下：貌似小版本之间的区别是没有的，这里因为找不到太过远古的ubuntu16的版本，就选择了ubuntu16.04，在glibc-all-in-one中可以找到: 2.23-0ubuntu11.3_amd64   题目没给怎么办？总有方法泄露的  1234ldd pwn2linux-vdso.so.10x00007ffce117c000libc.so.6 =&gt; /home/liiinkle/glibc-all-in-one/libs/2.23-0ubuntu11.3_amd64/libc.so.60x00007f592fc00000...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2025/03/21/%7BNewStarCTF%202023%7D%20srop/" title="[NewStarCTF 2023]srop"><img class="post-bg" src="/image/cover/linux.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="[NewStarCTF 2023]srop"></a></div><div class="recent-post-info"><a class="article-title" href="/2025/03/21/%7BNewStarCTF%202023%7D%20srop/" title="[NewStarCTF 2023]srop">[NewStarCTF 2023]srop</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-03-21T08:11:42.589Z" title="Created 2025-03-21 16:11:42">2025-03-21</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-03-26T12:16:28.268Z" title="Updated 2025-03-26 20:16:28">2025-03-26</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Pwn/">Pwn</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Srop/">Srop</a></span></div><div class="content">0x01 前言：Srop 初体验，总体上是要利用到pwntools集成的对于srop攻击的工具。 0x02 分析：先来 checksec： 0x03 Syscall你变了，你变得……上 ida 看看：是两个系统调用，但是参数非常奇怪，通常来说 rax 是装载系统调用号的，但是这两个调用里面 rax 都是 0，注意到在第一次 syscall 的时候，第二个参数在 rdx 上，给我的感觉就是传参的寄存器总体往后一了一位。先 gdb 看看怎么回事：步入了 syscall 函数里，一目了然了，主要动了手脚在这里 跟我们猜的一模一样，rdi 的值赋给 rax，rsi 的值赋给 rdi，也就是传参的寄存器总体后移了一位。接下来回到 main 函数，简单看看它做了什么：大概翻译了一下是这样两行函数，read 函数有溢出点，一般来说这样的题可能可以打 ret2csu，但是会在构造某个寄存器的值上会十分麻烦，所以这里着重介绍一下 srop，在程序中翻了翻可以找到： 0x04 调用号0xf是什么？看到这样一句，找了一下对应的系统调用： 打 srop...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2025/03/13/GHCTF_Pwn%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" title="GHCTF_PWN部分题解"><img class="post-bg" src="/image/cover/binary.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GHCTF_PWN部分题解"></a></div><div class="recent-post-info"><a class="article-title" href="/2025/03/13/GHCTF_Pwn%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" title="GHCTF_PWN部分题解">GHCTF_PWN部分题解</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-03-13T01:02:37.368Z" title="Created 2025-03-13 09:02:37">2025-03-13</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-03-25T16:13:26.137Z" title="Updated 2025-03-26 00:13:26">2025-03-26</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Pwn/">Pwn</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/pie/">pie</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/ret2libc/">ret2libc</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/one-gadget/">one_gadget</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/ret2csu/">ret2csu</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/vm-pwn/">vm pwn</a></span></div><div class="content">想说的话：作为一个练习时长半学期的PWN小萌新, 正好来打打这个GHCTF。看了下主办方说是新生赛，实际上他们面向的对象是练习了一学期的新生，所以有些题看到的第一时间还是比较懵的，不过好在最后成功做出来了5 &#x2F; 8题，还算可以吧。PWN学习之路还很长，慢慢坚持就好了。 1.Welcome come to the world of PWN0x01 前言：签到题，简单的ret2text和pie 0x02 分析：check一下:有pie，上ida看看：直奔主题，这里可以溢出，再看看有没有可以用的：发现了后门函数，而且跟main函数是连续的，所以只需要覆盖两个字节就能绕过pie 0x03 EXP：1234567891011121314151617181920212223242526272829303132333435363738394041from pwn import *from ctypes import *context(log_level = &#x27;debug&#x27;, arch = &#x27;amd64&#x27;, os =...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2025/02/27/ez_pz_hackover_2016/" title="ez_pz_hackover_2016"><img class="post-bg" src="/image/cover/hacker.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ez_pz_hackover_2016"></a></div><div class="recent-post-info"><a class="article-title" href="/2025/02/27/ez_pz_hackover_2016/" title="ez_pz_hackover_2016">ez_pz_hackover_2016</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-02-27T02:34:48.596Z" title="Created 2025-02-27 10:34:48">2025-02-27</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-03-26T12:16:03.291Z" title="Updated 2025-03-26 20:16:03">2025-03-26</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Pwn/">Pwn</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/ret2libc/">ret2libc</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/strcmp%E7%BB%95%E8%BF%87/">strcmp绕过</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/patchelf/">patchelf</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/stack-overflow/">stack overflow</a></span></div><div class="content">0x01：前言vc哥通过这题给我讲解了很多pwn题的细节，通过写这题的wp简单的记录一下，题目本身一个strcmp绕过+ret2libc 0x02：题目分析check：没有NX？ida看看吧：跟进header():继续往下看：可以看到fgets()但是读取的长度不足以溢出，继续往下看，发现有个vuln函数，跟进：发现memcpy()且第三个参数很大，可以溢出，那么我们要构造的payload就是先绕过chall()函数里面的strcmp()，最后做个ret2libc： 1234567printf_got=elf.got[&#x27;printf&#x27;]printf_plt=elf.plt[&#x27;printf&#x27;]chall_addr=0x08048603payload=b&#x27;crashme\x00&#x27;+b&#x27;a&#x27;*(0x32+4-8)+p32(printf_plt)+p32(chall_addr)+p32(printf_got)debug()sla(&#x27;&gt;...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2025/02/24/Fuko's%20starfish/" title="VNCTF2025_Fuko's starfish"><img class="post-bg" src="/image/cover/starfish.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="VNCTF2025_Fuko's starfish"></a></div><div class="recent-post-info"><a class="article-title" href="/2025/02/24/Fuko's%20starfish/" title="VNCTF2025_Fuko's starfish">VNCTF2025_Fuko's starfish</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-02-24T02:49:43.742Z" title="Created 2025-02-24 10:49:43">2025-02-24</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-03-26T12:15:54.447Z" title="Updated 2025-03-26 20:15:54">2025-03-26</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Reverse/">Reverse</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/AES%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E8%AF%86%E5%88%AB/">AES加密算法识别</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E8%8A%B1%E6%8C%87%E4%BB%A4/">花指令</a></span></div><div class="content">0x01:前言主要还是加密算法识别，花指令识别，dll反调试（非必要） 0x02:分析比赛版当中的分析题目提供了一个exe以及一个dll，exe无壳，ida启动：暂时没看到flag的密文,考虑硬玩ing第一个是猜1到100的随机数,第二个游戏是贪吃蛇怎么操作噢在dll里面这里接收输入贪吃蛇游戏界面,wasd操作我先玩玩还有一个,先在ida里面翻一下好像是这个函数,有花:去一下flag密文应该是这一串, 就是那个while(里面的byte_1800A890) 1234567unsigned char ida_chars[] =&#123;    0x3D, 0x01, 0x1C, 0x19, 0x0B, 0xA0, 0x90, 0x81, 0x5F, 0x67,    0x27, 0x31, 0xA8, 0x9A, 0xA4, 0x74, 0x97, 0x36, 0x21, 0x67,    0xAB, 0x2E, 0xB4, 0xA0, 0x94, 0x18, 0xD3, 0x7D, 0x93, 0xE6,    0x46, 0xE7&#125;; 看起来明文长度应该是16,...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2025/02/24/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%912025_BitDance/" title="西湖论剑2025_BitDance"><img class="post-bg" src="/image/cover/blackbox.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="西湖论剑2025_BitDance"></a></div><div class="recent-post-info"><a class="article-title" href="/2025/02/24/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%912025_BitDance/" title="西湖论剑2025_BitDance">西湖论剑2025_BitDance</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-02-23T16:00:41.015Z" title="Created 2025-02-24 00:00:41">2025-02-24</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-03-26T12:16:10.796Z" title="Updated 2025-03-26 20:16:10">2025-03-26</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Reverse/">Reverse</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Block-box-testing/">Block box testing</a></span></div><div class="content">0x01 前言：遇见的第一题没有附件的RE题，原来这种题目叫黑盒测试？ 0x02 分析题目只给了一个靶机，连接上去之后提示输入：（没存图片，这里借队友的用一下）输入不同长度的字符串会提示Wrong length， 总之先把长度给爆破出来，这里可以使用python的pwn库，也就是pwn常用工具pwntools： 123456789101112131415161718//字符长度爆破脚本from pwn import *context(log_level = &#x27;debug&#x27;, arch = &#x27;amd64&#x27;, os = &#x27;linux&#x27;)xihu=&#x27;139.155.126.78&#x27;stop=1text_len=&#x27;&#x27;while(stop):    p = remote(xihu,24847)      text_len+=&#x27;a&#x27;    p.sendlineafter(&#x27;Welcome to dance: &#x27;,text_len)    if...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2025/02/24/%7BNewStarCTF%202023%7Dcanary/" title="[NewStarCTF 2023]canary"><img class="post-bg" src="/image/cover/canary.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="[NewStarCTF 2023]canary"></a></div><div class="recent-post-info"><a class="article-title" href="/2025/02/24/%7BNewStarCTF%202023%7Dcanary/" title="[NewStarCTF 2023]canary">[NewStarCTF 2023]canary</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-02-23T16:00:41.014Z" title="Created 2025-02-24 00:00:41">2025-02-24</time><span class="article-meta-separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-03-26T12:16:23.381Z" title="Updated 2025-03-26 20:16:23">2025-03-26</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Pwn/">Pwn</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Canary/">Canary</a><span class="article-meta-link">•</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/fmtstr/">fmtstr</a></span></div><div class="content">0x01 前言:初见Canary保护，主要还是了解Canary的原理以及如何绕过 0x02 分析:check: 可以看到开了canary保护  原理是在一个函数的入口，先从fs&#x2F;gs寄存器中取出一个四字节(eax)或者八字节的rax的值存在栈上(最低位都是\x00)，当函数结束是会检查这个栈上的值是否和存在去的值一致，若一致则正常退出，如果是栈溢出或者其他原因导致canary的值发生变化，那么程序就会执行___stack_chk_fali函数，继而保护程序  我们先打开ida看看:可以看到有printf, 大致的思路就是通过字符串格式化漏洞, 把字符串的偏移给找出来, 然后通过下面的read做栈溢出, 正常溢出到后门函数, 但是在溢出的时候我们把canary的值给修改了, 所以在构造payload的时候需要注意payload的结构, 首先我们先执行下这个程序:可以看到字符串的偏移是6, 接下来用gdb看看canary在哪里, 我们先在main函数的call printf这里下一个断点:首先启动gdb, 输入 1gdb...</div></div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/#content-inner">2</a><a class="extend next" rel="next" href="/page/2/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/image/icon.jpg" onerror="this.onerror=null;this.src='/img/icon.jpg'" alt="avatar"/></div><div class="author-info-name">L1nk</div><div class="author-info-description">hi, I am Li1nk</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">24</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Li1nk3"><i class="/img/icon.jpg"></i><span>Follow Me</span></a></div><div class="sticky_layout"><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>Categories</span>
            
          </div>
          <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Pwn/"><span class="card-category-list-name">Pwn</span><span class="card-category-list-count">8</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Reverse/"><span class="card-category-list-name">Reverse</span><span class="card-category-list-count">3</span></a></li>
          </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>Tags</span></div><div class="card-tag-cloud"><a href="/tags/ret2csu/" style="font-size: 1.1em; color: #999">ret2csu</a> <a href="/tags/stack-overflow/" style="font-size: 1.1em; color: #999">stack overflow</a> <a href="/tags/realloc-hook/" style="font-size: 1.1em; color: #999">realloc_hook</a> <a href="/tags/ret2libc/" style="font-size: 1.5em; color: #99a9bf">ret2libc</a> <a href="/tags/%E5%A0%86%E6%BA%A2%E5%87%BA/" style="font-size: 1.1em; color: #999">堆溢出</a> <a href="/tags/malloc-hook/" style="font-size: 1.1em; color: #999">malloc_hook</a> <a href="/tags/strcmp%E7%BB%95%E8%BF%87/" style="font-size: 1.1em; color: #999">strcmp绕过</a> <a href="/tags/fast-bin-attack/" style="font-size: 1.1em; color: #999">fast bin attack</a> <a href="/tags/fmtstr/" style="font-size: 1.1em; color: #999">fmtstr</a> <a href="/tags/%E8%B0%83%E8%8A%82%E6%A0%88%E5%B8%A7/" style="font-size: 1.1em; color: #999">调节栈帧</a> <a href="/tags/patchelf/" style="font-size: 1.1em; color: #999">patchelf</a> <a href="/tags/vm-pwn/" style="font-size: 1.1em; color: #999">vm pwn</a> <a href="/tags/heap-overflow/" style="font-size: 1.1em; color: #999">heap overflow</a> <a href="/tags/pie/" style="font-size: 1.5em; color: #99a9bf">pie</a> <a href="/tags/realloc/" style="font-size: 1.1em; color: #999">realloc</a> <a href="/tags/%E8%8A%B1%E6%8C%87%E4%BB%A4/" style="font-size: 1.1em; color: #999">花指令</a> <a href="/tags/one-gadget/" style="font-size: 1.1em; color: #999">one_gadget</a> <a href="/tags/Assembly-language/" style="font-size: 1.1em; color: #999">Assembly language</a> <a href="/tags/Srop/" style="font-size: 1.1em; color: #999">Srop</a> <a href="/tags/Canary/" style="font-size: 1.1em; color: #999">Canary</a> <a href="/tags/glibc-all-in-one/" style="font-size: 1.1em; color: #999">glibc-all-in-one</a> <a href="/tags/Block-box-testing/" style="font-size: 1.1em; color: #999">Block box testing</a> <a href="/tags/Tcache-attack/" style="font-size: 1.1em; color: #999">Tcache attack</a> <a href="/tags/AES%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E8%AF%86%E5%88%AB/" style="font-size: 1.1em; color: #999">AES加密算法识别</a></div></div><div class="card-widget card-archives">
    <div class="item-headline">
      <i class="fas fa-archive"></i>
      <span>Archives</span>
      
    </div>
  
    <ul class="card-archive-list">
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2025/04/">
            <span class="card-archive-list-date">
              四月 2025
            </span>
            <span class="card-archive-list-count">3</span>
          </a>
        </li>
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2025/03/">
            <span class="card-archive-list-date">
              三月 2025
            </span>
            <span class="card-archive-list-count">3</span>
          </a>
        </li>
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2025/02/">
            <span class="card-archive-list-date">
              二月 2025
            </span>
            <span class="card-archive-list-count">5</span>
          </a>
        </li>
      
    </ul>
  </div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>Website Info</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">Article Count :</div><div class="item-count">11</div></div><div class="webinfo-item"><div class="item-name">Unique Visitors :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">Page Views :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">Last Update :</div><div class="item-count" id="last-push-date" data-lastPushDate="2025-04-11T12:12:32.641Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer" style="background: transparent;"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By L1nk</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>window.typedJSFn = {
  init: str => {
    window.typed = new Typed('#subtitle', Object.assign({
      strings: str,
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50,
    }, null))
  },
  run: subtitleType => {
    if (true) {
      if (typeof Typed === 'function') {
        subtitleType()
      } else {
        btf.getScript('https://cdn.jsdelivr.net/npm/typed.js/dist/typed.umd.min.js').then(subtitleType)
      }
    } else {
      subtitleType()
    }
  }
}
btf.addGlobalFn('pjaxSendOnce', () => { typed.destroy() }, 'typedDestroy')
</script><script>function subtitleType () {
  if (true) {
    typedJSFn.init(["Hey!  &#44; Listen!"])
  } else {
    document.getElementById("subtitle").textContent = "Hey!  &#44; Listen!"
  }
}
typedJSFn.run(subtitleType)</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>